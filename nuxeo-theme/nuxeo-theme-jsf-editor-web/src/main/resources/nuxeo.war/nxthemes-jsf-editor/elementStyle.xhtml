<div xmlns="http://www.w3.org/1999/xhtml"
  xmlns:nxthemes="http://nuxeo.org/nxthemes"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:ui="http://java.sun.com/jsf/facelets">

  <c:choose>
    <c:when test="${nxthemesUiManager.styleOfSelectedElement == null}">
      <form action="" class="nxthemesForm"
        onsubmit="NXThemesStyleEditor.createStyle(); return false;">
        <div>
          The element has no style.
          <button>
            Create a style
          </button>
        </div>
      </form>
    </c:when>
    <c:otherwise>

      <style id="previewCss" type="text/css"></style>

      <div class="nxthemesButtonSelector"
        style="text-align: left; padding: 4px 15px;">
        <span>Layers: </span>
        <ui:repeat value="#{nxthemesUiManager.styleLayersOfSelectedElement}"
          var="layer">
          <span><h:outputText escape="false" value="#{layer.rendered}" />
          </span>
        </ui:repeat>
      </div>

      <table style="width: 100%" cellpadding="10" cellspacing="0">
        <tr>
          <td style="width: 50%; vertical-align: top">
            <fieldset class="nxthemesEditor">
              <legend>
                Preview
              </legend>

              <div id="stylePreviewArea"
                element="#{nxthemesUiStates.selectedElement.uid}">
                <img src="/nuxeo/nxthemes-jsf-editor/img/progressbar.gif" alt=""
                  width="220" height="19"
                  style="padding: 5px; border: 1px solid #ccc; background-color: #fff" />
                <nxthemes:view resource="style-preview.json" />
              </div>
            </fieldset>
            <div id="labelInfo" style="display:none" />

          </td>
          <td style="width: 50%; vertical-align: top">

            <!--  Style properties form -->
            <nxthemes:panel identifier="style properties"
              url="/nuxeo/nxthemes-jsf-editor/styleProperties.faces"
              controlledBy="style editor perspectives,style editor actions,element form actions"
              visibleInPerspectives="style properties,style picker" />

            <!--  Style picker -->
            <nxthemes:panel identifier="style picker"
              url="/nuxeo/nxthemes-jsf-editor/stylePicker.faces"
              controlledBy="style editor perspectives,toolbox mover"
              visibleInPerspectives="style picker" />

          </td>
        </tr>
      </table>
    </c:otherwise>
  </c:choose>

</div>
