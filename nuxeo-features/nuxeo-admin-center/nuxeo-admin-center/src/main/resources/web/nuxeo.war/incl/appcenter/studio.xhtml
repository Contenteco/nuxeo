<div xmlns:h="http://java.sun.com/jsf/html"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:c="http://java.sun.com/jstl/core">

  <a4j:outputPanel id="connectAppListing">
    <div class="actionBar marketplace">
    	<span class="marketplaceLogo"><a target="_blank" href="https://doc.nuxeo.com/display/Studio/Nuxeo+Studio+Documentation+Center"><img src="/nuxeo/img/nuxeo_studio_logo.png" alt="Nuxeo Studio" /></a></span>
    	<span class="label"><a class="connectLink" target="_blank" href="https://doc.nuxeo.com/display/Studio/Nuxeo+Studio+Documentation+Center"><h:outputText value="#{messages['label.tab.studio.intro']}"/></a></span>
    </div>
    
		<div class="actionBar">
      <h:panelGroup rendered="#{!appsViews.isStudioSnapshopUpdateInProgress()}">
        <div>
          <h:outputText value="#{messages['label.studio.update.lastStatus']}"/>
          <h:outputText value="#{appsViews.getStudioInstallationStatus()}" styleClass="boldLabel"/>
        </div>
      </h:panelGroup>
      
      <h:form>
      	<a4j:poll interval="1000" enabled="#{appsViews.isStudioSnapshopUpdateInProgress()}" reRender="connectAppListing"/>
    	</h:form>
    	
    	<h:panelGroup rendered="#{!appsViews.isStudioSnapshopUpdateInProgress()}">
    	  <div class="studioUpdateActions">
          <h:outputText value="#{messages['label.studio.update']}" styleClass="boldLabel"/>
          <h:outputText value="#{messages['label.studio.latest.config']}"/> 
          <h:outputText value="#{messages['label.studio.refresh']}" styleClass="boldLabel"/> 
          <h:outputText value="#{messages['label.studio.tagged.version']}"/>
        </div>
        <h:form>
          <a4j:commandButton value="#{messages['admCommand.studio.update']}" actionListener="#{appsViews.installStudioSnapshot()}"  reRender="connectAppListing" />
          <a4j:commandButton value="#{messages['admCommand.studio.refresh']}" actionListener="#{appsViews.flushCache()}"  reRender="connectAppListing" />
        </h:form>
    	</h:panelGroup>
    </div>


    <h:panelGroup rendered="#{appsViews.isStudioSnapshopUpdateInProgress()}" styleClass="boldLabel">
      <div class="actionBar marketplace">
       <h:outputText value="#{messages['label.studio.update.inprogress']}"/>
       <h:outputText value="#{appsViews.getStudioInstallationStatus()}"/>
      </div>
    </h:panelGroup>


  <c:if test="#{connectServerReachable and registredConnectInstance}">
    <iframe src="/nuxeo/site/connectClient/packages/studio" frameborder="0" scrolling="auto" width="100%" height="300px">
      <img src="/nuxeo/img/big_loading.gif"/>
    </iframe>
    </c:if>

  <c:if test="#{not connectServerReachable}">
     <h:outputText value="#{messages[adminsubtab.servernotreachable]}" />
  </c:if>

  <c:if test="#{not registredConnectInstance}">
   <h:outputText value="#{messages[adminsubtab.registrationRequired]}" />
  </c:if>

  </a4j:outputPanel>

</div>
