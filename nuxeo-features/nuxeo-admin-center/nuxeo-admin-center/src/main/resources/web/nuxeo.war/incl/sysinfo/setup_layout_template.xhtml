<a4j:outputPanel
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:fn="http://java.sun.com/jsp/jstl/functions"
  id="#{nxu:test(empty layout.properties.ajaxPanelId, layout.id, layout.properties.ajaxPanelId)}">

<c:if test="#{not empty layout.rows}">

<c:set var="isEditMode" value="#{nxl:isBoundToEditMode(layout.mode)}" />

<table class="dataOutput">
  <tbody>
    <c:if test="#{not empty layout.properties.label}">
      <tr>
        <th colspan="2">
          <h:outputText value="#{messages[layout.properties.label]}" />
        </th>
      </tr>
    </c:if>

    <tr><td><table><tbody>

    <nxl:layoutRow>
      <nxl:layoutRowWidget>
        <tr>
          <c:if test="#{not layoutRow.properties.hideWidgetLabel}">
            <c:choose>
              <c:when test="#{widget.translated}">
                <td class="wideLabel">
                  <c:if test="#{empty widget.helpLabel}">
                    <h:outputText value="#{messages[widget.label]}"
                      styleClass="#{nxu:test(widget.required and isEditMode, 'required', '')}" />
                  </c:if>
                  <c:if test="#{!empty widget.helpLabel}">
                    <div class="widgetHelpLabel">
                      <h:outputText value="#{messages[widget.label]}"
                        styleClass="#{nxu:test(widget.required and isEditMode, 'required', '')}" />
                    </div>
                    <div class="tooltip">
                      #{messages[widget.helpLabel]}
                    </div>
                  </c:if>
                </td>
              </c:when>
              <c:otherwise>
                <td class="wideLabel">
                  <c:if test="#{empty widget.helpLabel}">
                    <h:outputText value="#{widget.label}"
                      styleClass="#{nxu:test(widget.required and isEditMode, 'required', '')}" />
                  </c:if>
                  <c:if test="#{!empty widget.helpLabel}">
                    <div class="widgetHelpLabel">
                      <h:outputText value="#{widget.label}"
                        styleClass="#{nxu:test(widget.required and isEditMode, 'required', '')}" />
                    </div>
                    <div class="tooltip">
                      #{widget.helpLabel}
                    </div>
                  </c:if>
                </td>
              </c:otherwise>
            </c:choose>
          </c:if>
          <nxu:set
            var="fieldDef"
            value="#{widget.fieldDefinitions[0].propertyName}">
            <c:if test="#{not empty fieldDef}">
              <c:set var="displayId"
                value="#{fn:substring(fieldDef, 2, fn:length(fieldDef) - 2)}" />
            </c:if>
            <td class="fieldColumn"
              id="#{displayId}"
              colspan="#{nxu:test(layoutRow.properties.hideWidgetLabel, 2, 1)}">
              <nxl:widget widget="#{widget}" value="#{value}" />
            </td>
          </nxu:set>
        </tr>

      </nxl:layoutRowWidget>
    </nxl:layoutRow>

    </tbody></table></td></tr>

  </tbody>
</table>

<script>
  jQuery(document).ready(function() {
    jQuery(".widgetHelpLabel").tooltip({relative: true, position: 'bottom center'});
  });
</script>

</c:if>
</a4j:outputPanel>