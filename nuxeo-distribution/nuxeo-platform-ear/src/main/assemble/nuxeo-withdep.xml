<assembly>

  <!-- RESOURCES -->
  <assemble>
    <set>resources</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources">
    <artifact>
      org.nuxeo.ecm.platform:nuxeo-platform-ear:${project.version}:zip:resources-mono
    </artifact>
  </zipEntrySet>
  <assemble>
    <set>resources-derby</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources-derby" profile="derby">
    <artifact>
      org.nuxeo.ecm.platform:nuxeo-platform-ear:${project.version}:zip:resources-derby
    </artifact>
  </zipEntrySet>
  <assemble>
    <set>resources-mysql</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources-mysql" profile="mysql">
    <artifact>
      org.nuxeo.ecm.platform:nuxeo-platform-ear:${project.version}:zip:resources-mysql
    </artifact>
  </zipEntrySet>
  <assemble>
    <set>resources-postgresql</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources-postgresql" profile="postgresql">
    <artifact>
      org.nuxeo.ecm.platform:nuxeo-platform-ear:${project.version}:zip:resources-postgresql
    </artifact>
  </zipEntrySet>
  <assemble>
    <set>resources-oracle</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources-oracle" profile="oracle">
    <artifact>
      org.nuxeo.ecm.platform:nuxeo-platform-ear:${project.version}:zip:resources-oracle
    </artifact>
  </zipEntrySet>
  <assemble>
    <set>resources-h2</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources-h2" profile="h2">
    <artifact>
      org.nuxeo.ecm.platform:nuxeo-platform-ear:${project.version}:zip:resources-h2
    </artifact>
  </zipEntrySet>
  <assemble>
    <set>resources-jcr</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources-jcr" profile="jcr-profile">
    <artifact>
      org.nuxeo.ecm.platform:nuxeo-platform-ear:${project.version}:zip:resources-jcr
    </artifact>
  </zipEntrySet>
  <assemble>
    <set>resources-jcr-postgresql</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources-jcr-postgresql" profile="jcr-postgresql">
    <artifact>
      org.nuxeo.ecm.platform:nuxeo-platform-ear:${project.version}:zip:resources-jcr-postgresql
    </artifact>
  </zipEntrySet>

  <!-- ARTIFACTS -->
  <assemble>
    <outputFile>/</outputFile>
    <set>root-artifacts</set>
  </assemble>
  <artifactSet id="root-artifacts">
    <import>**</import>
    <includeDependencies>false</includeDependencies>
    <includes>
      <artifact name="nuxeo-platform-webapp" />
      <artifact name="nuxeo-platform-webapp-core" />
    </includes>
  </artifactSet>

  <assemble>
    <outputFile>system</outputFile>
    <set>system</set>
  </assemble>
  <artifactSet id="system">
    <import>**</import>
    <includeDependencies>true</includeDependencies>
    <includes>
      <artifact group="org.nuxeo*" category="runtime,jboss4"
        includeDependsOnCategory="false" />
      <artifact group="org.nuxeo*" category="core,search,web,stateful,stateless" />
      <!-- add here nuxeo-addons -->
    </includes>
    <excludes>
      <artifact group="!org.nuxeo*" />
      <artifact group="org.nuxeo.common" />
      <artifact name="nuxeo-runtime-jboss-extensions" />
      <artifact name="nuxeo-generic-wss-handler" />

      <artifact name="nuxeo-platform-webapp" />
      <artifact name="nuxeo-platform-webapp-core" />

      <artifact name="nuxeo-platform-audit-facade" />
      <artifact name="nuxeo-platform-placeful-facade" />
      <artifact name="nuxeo-apt-extensions" />
      <artifact name="nuxeo-webengine-apt" />
      <artifact name="nuxeo-platform-ear" />
    </excludes>
  </artifactSet>

  <assemble>
    <delete>true</delete>
    <outputFile>system</outputFile>
    <file>nuxeo-platform-ear-${project.version}.pom</file>
  </assemble>

  <assemble>
    <outputFile>system</outputFile>
    <unpack>true</unpack>
    <unpackInNewDirectory>true</unpackInNewDirectory>
    <set>nuxeo-platform-unpacked</set>
  </assemble>
  <artifactSet id="nuxeo-platform-unpacked">
    <import>**</import>
    <includes>
      <artifact name="nuxeo-platform-audit-facade" />
      <artifact name="nuxeo-platform-placeful-facade" />
    </includes>
  </artifactSet>

  <!-- third party libraries based on dependencies -->
  <assemble>
    <outputFile>lib</outputFile>
    <set>nuxeo-libs-via-dependency-tree</set>
  </assemble>
  <artifactSet id="nuxeo-libs-via-dependency-tree">
    <import>**</import>
    <includeDependencies>true</includeDependencies>
    <includes>
      <artifact scope="compile" />
    </includes>
    <excludes>
      <artifact group="org.nuxeo*" />
      <artifact name="jackrabbit-jcr-commons" />
      <artifact name="stax-api" />
      <artifact name="xercesImpl" />
      <artifact name="xmlParserAPIs" />
      <artifact name="hibernate" />
      <artifact name="log4j" />
      <artifact name="servlet-api" />
      <artifact name="xml-apis" />
      <artifact name="jta" />
      <artifact name="derby" />
      <artifact name="jackrabbit-core" />
      <artifact name="persistence-api" />
      <artifact name="dom4j" />
      <artifact group="org.freemarker" name="freemarker" />
      <artifact group="commons-lang" name="commons-lang" />
    </excludes>
  </artifactSet>

  <!-- CUSTOM RESOURCES -->
  <!--
    <assemble> <outputFile>/</outputFile> <set>custom-resources</set>
    </assemble> <fileSet id="custom-resources">
    <directory>src/main/resources_custom</directory> </fileSet>
  -->

  <!-- CUSTOM ARTIFACTS -->
  <!--
    <assemble> <outputFile>plugins</outputFile> <set>custom-plugins</set>
    </assemble> <artifactSet id="custom-plugins"> <import>**</import>
    <includeDependencies>false</includeDependencies> <includes> <artifact
    group="com.custom.sample" /> </includes> </artifactSet>
  -->
</assembly>
