<c:if test="#{widget.mode != 'after_view' and widget.mode != 'tab_content'}"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:h="http://java.sun.com/jsf/html">

  <nxu:set var="requireDocument" value="#{action.properties.requireDocument}"
    cache="true">
  <nxu:set var="onclick"
    value="#{nxu:test(not empty action.properties.confirmMessage, actionConfirmMessageJs, '')}#{action.confirm};#{action.properties.onclick};"
    cache="true">

    <c:if test="#{not empty requireDocument}">
      <nxd:restDocumentLink document="#{mainTabsActions.getDocumentFor(action.id)}"
        view="#{mainTabsActions.getViewFor(action)}"
        pattern="#{mainTabsActions.getPatternFor(action)}"
        addTabInfo="false"
        target="#{action.properties.target}"
        tabs="MAIN_TABS:#{action.id}"
        onclick="#{onclick}"
        accesskey="#{action.accessKey}">
        <h:outputText value="#{messages[action.label]}" />
      </nxd:restDocumentLink>
    </c:if>
    <c:if test="#{empty requireDocument}">
      <nxd:restDocumentLink document="#{mainTabsActions.getDocumentFor(action.id)}"
        repositoryName="#{navigationContext.currentServerLocation.name}"
        view="#{mainTabsActions.getViewFor(action)}"
        pattern="#{mainTabsActions.getPatternFor(action)}"
        addTabInfo="false"
        target="#{action.properties.target}"
        tabs="MAIN_TABS:#{action.id}"
        onclick="#{onclick}"
        accesskey="#{action.accessKey}">
        <h:outputText value="#{messages[action.label]}" />
      </nxd:restDocumentLink>
    </c:if>

  </nxu:set>
  </nxu:set>

</c:if>