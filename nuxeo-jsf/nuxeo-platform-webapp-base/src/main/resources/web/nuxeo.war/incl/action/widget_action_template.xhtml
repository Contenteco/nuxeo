<c:if test="true"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:nxl="http://nuxeo.org/nxforms/layout">

  <nxu:set var="resolvedMode"
    value="#{nxu:test(empty action.properties.widgetMode, empty widget.mode?'view':widget.mode, action.properties.widgetMode)}">

  <nxu:set var="addForm"
    value="#{action.properties.addForm}" resolveTwice="true">
    <c:if test="#{action.properties.displayActionLabel}">
      <ui:include src="/incl/action/action_icon_label_template.xhtml" />
      <h:outputText value=" " />
    </c:if>
    <c:if test="#{addForm}">
      <h:form id="#{layout.id}_#{widget.id}_form"
        enctype="multipart/form-data">
        <nxl:widget
          name="#{action.properties.widgetName}"
          mode="#{resolvedMode}"
          category="#{empty action.properties.widgetCategory ? '': action.properties.widgetCategory}"
          layoutName="#{idPrefix}#{action.id}"
          value="#{fieldOrValue}">
          <c:if test="#{action.properties.displayWidgetLabel}">
            <ui:include src="/widgets/incl/widget_label_template.xhtml" />
            <h:outputText value=" " />
          </c:if>
        </nxl:widget>
      </h:form>
    </c:if>
    <c:if test="#{not addForm}">
      <nxl:widget
        name="#{action.properties.widgetName}"
        mode="#{resolvedMode}"
        category="#{empty action.properties.widgetCategory ? '': action.properties.widgetCategory}"
        layoutName="#{idPrefix}#{action.id}"
        value="#{fieldOrValue}">
        <c:if test="#{action.properties.displayWidgetLabel}">
          <ui:include src="/widgets/incl/widget_label_template.xhtml" />
          <h:outputText value=" " />
        </c:if>
      </nxl:widget>
    </c:if>
  </nxu:set>
  </nxu:set>

</c:if>
