<div xmlns:h="http://java.sun.com/jsf/html"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:c="http://java.sun.com/jstl/core">
  <h:form id="documentActionsUpperButtons">
    <div class="globalActionBar">
      <nxu:set var="category"
        value="#{nxu:test(empty widgetProperty_category, 'DOCUMENT_UPPER_ACTION', widgetProperty_category)}"
        cache="true">
        <nxu:set var="actions"
          value="#{webActions.getActionsList(category)}" cache="true">
          <div class="contextActions">
            <c:forEach var="action" begin="0" end="4" step="1"
              items="#{actions}">
              <div>
                <ui:decorate
                  template="/incl/generic_action_template.xhtml" />
              </div>
            </c:forEach>
            <!-- Display rollover after 5 actions -->
            <c:if test="#{actions.size>5}">
              <ul class="actionList">
                <li class="dropDownMenu button dropdown">More
                <ul class="actionSubList">
                  <c:forEach var="action" begin="5"
                    end="#{actions.size-1}" step="1" items="#{actions}">
                    <li><nxh:commandLink
                        action="#{action.getLink()}"
                        immediate="#{action.immediate}"
                        onclick="#{action.confirm}">
                        <h:graphicImage value="#{action.icon}"
                          rendered="#{not empty action.icon}"
                          title="#{messages[action.label]}"
                          alt="#{messages[action.label]}"
                          styleClass="smallIcon" />
                        <h:outputText value="#{messages[action.label]}" />
                      </nxh:commandLink></li>
                  </c:forEach>
                </ul>
                </li>
              </ul>
              <script type="text/javascript">
              jQuery(document).ready(function($) {
                jQuery('.dropDownMenu').click(function(e) {
                  jQuery(this).find('ul').hide();
                  jQuery(this).find("ul").show();
                  e.stopPropagation();
                });
                jQuery(document).click(function() {
                  jQuery('.dropDownMenu').find('ul').hide();
                });
              });
              </script>
            </c:if>
          </div>
        </nxu:set>
      </nxu:set>
    </div>
  </h:form>
</div>
