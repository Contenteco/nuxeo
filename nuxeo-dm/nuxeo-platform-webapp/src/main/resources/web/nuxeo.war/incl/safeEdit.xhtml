<div xmlns:h="http://java.sun.com/jsf/html"
 xmlns:nxu="http://nuxeo.org/nxweb/util"
 xmlns:ui="http://java.sun.com/jsf/facelets"
 xmlns:c="http://java.sun.com/jstl/core">

<c:if test="false">
  Parameters:
  - safeEdit_form: id of the form to make save
  - safeEdit_mode: mode of the for create/edit
</c:if>

<c:if test="#{safeEdit_form==null}">
  <c:set var="safeEdit_form" value="document_edit" />
</c:if>
<c:if test="#{safeEdit_mode==null}">
  <c:set var="safeEdit_mode" value="edit" />
</c:if>

<script src="#{contextPath}/scripts/safeEdit.js"></script>
<script src="#{contextPath}/scripts/safeEditUI.js"></script>

<span id="confirmRestore" style="display:none;float:right" class="infoMessage">
 Do you want to restore saved data :
 <A id="confirmRestoreYes" href="#confirmRestoreYes"> Yes </A>
 <A id="confirmRestoreNo" href="#confirmRestoreNo" > No </A> ?
</span>
<span id="savedFeedback" style="display:none;float:right" class="infoMessage">
 Draft saved !
</span>

<script>
    var dropSafeEdit=null;
    jQuery(document).ready(function() {
       // define  the formKey
       var formKey ='#{currentDocument.id}';
       <c:if test="#{safeEdit_mode == 'create'}">
       formKey ='create-' + formKey + '-#{changeableDocument.type}';
       </c:if>
       initSafeEditOnForm('#{safeEdit_form}', formKey);
       dropSafeEdit = function() { cleanupSavedData(formKey) };
    });

</script>

</div>
