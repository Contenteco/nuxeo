<div xmlns:h="http://java.sun.com/jsf/html"
    xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
    xmlns:nxu="http://nuxeo.org/nxweb/util"
    xmlns:nxd="http://nuxeo.org/nxweb/document"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"><a4j:outputPanel
    id="setupPanel" ajaxRendered="true">
    <!-- 
    <span><h:outputText value="DEBUG: Configurable: #{configurable}" /></span>
    <br />
    <span><h:outputText
        value="DEBUG: nuxeo.dbtemplate #{setupParams['nuxeo.dbtemplate']}" /></span>
    <br /> -->

    <ui:include src="/incl/message_banner.xhtml" />

    <h:panelGroup rendered="#{setupRequiresRestart}">
        <div class="warningFeedback"><h:outputText
            value="#{messages['label.setup.restartNeeded']}" /></div>
        <br />
    </h:panelGroup>
    <h:panelGroup rendered="#{!configurable}">
        <div class="warningFeedback"><h:outputText
            value="#{messages['label.setup.notconfigurable']}" /></div>
        <br />
    </h:panelGroup>

    <h2><h:outputText styleClass="label"
        value="#{messages['adminsubtab.sysinfo.setup']}" /></h2>
    <c:if test="#{configurable}">
        <a4j:form>
            <table>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.database.templates']}" /></td>
                    <td><h:selectOneMenu class="dataInputText"
                        immediate="true"
                        value="#{setupParams['nuxeo.dbtemplate']}">
                        <f:selectItem itemValue="default"
                            itemLabel="#{messages['label.setup.nuxeo.template.default']}" />
                        <f:selectItem itemValue="postgresql"
                            itemLabel="#{messages['label.setup.nuxeo.template.postgresql']}" />
                        <f:selectItem itemValue="oracle"
                            itemLabel="#{messages['label.setup.nuxeo.template.oracle']}" />
                        <f:selectItem itemValue="mysql"
                            itemLabel="#{messages['label.setup.nuxeo.template.mysql']}" />
                        <f:selectItem itemValue="mssql"
                            itemLabel="#{messages['label.setup.nuxeo.template.mssql']}" />
                        <a4j:support event="onchange" reRender="setupPanel"
                            actionListener="#{setupWizardAction.templateChange}">
                        </a4j:support>
                    </h:selectOneMenu></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.nuxeo.bind.address']}" /></td>
                    <td><h:inputText class="dataInputText" size="15"
                        value="#{setupParams['nuxeo.bind.address']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.nuxeo.url']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['nuxeo.url']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.org.nuxeo.ecm.instance.name']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['org.nuxeo.ecm.instance.name']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.org.nuxeo.ecm.instance.description']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['org.nuxeo.ecm.instance.description']}" /></td>
                </tr>

                <c:if test="#{setupParams['nuxeo.dbtemplate']!='default'}">
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{messages['label.setup.nuxeo.db.name']}" /></td>
                        <td><h:inputText class="dataInputText" size="50"
                            value="#{setupParams['nuxeo.db.name']}" /></td>
                    </tr>
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{messages['label.setup.nuxeo.db.user']}" /></td>
                        <td><h:inputText class="dataInputText" size="50"
                            value="#{setupParams['nuxeo.db.user']}" /></td>
                    </tr>
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{messages['label.setup.nuxeo.db.password']}" /></td>
                        <td><h:inputText class="dataInputText" size="50"
                            value="#{setupParams['nuxeo.db.password']}" /></td>
                    </tr>
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{messages['label.setup.nuxeo.db.host']}" /></td>
                        <td><h:inputText class="dataInputText" size="50"
                            value="#{setupParams['nuxeo.db.host']}" /></td>
                    </tr>
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{messages['label.setup.nuxeo.db.port']}" /></td>
                        <td><h:inputText class="dataInputText" size="50"
                            value="#{setupParams['nuxeo.db.port']}" /></td>
                    </tr>
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{messages['label.setup.nuxeo.db.min-pool-size']}" /></td>
                        <td><h:inputText class="dataInputText" size="50"
                            value="#{setupParams['nuxeo.db.min-pool-size']}" /></td>
                    </tr>
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{messages['label.setup.nuxeo.db.max-pool-size']}" /></td>
                        <td><h:inputText class="dataInputText" size="50"
                            value="#{setupParams['nuxeo.db.max-pool-size']}" /></td>
                    </tr>
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{messages['label.setup.nuxeo.vcs.min-pool-size']}" /></td>
                        <td><h:inputText class="dataInputText" size="50"
                            value="#{setupParams['nuxeo.vcs.min-pool-size']}" /></td>
                    </tr>
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{messages['label.setup.nuxeo.vcs.max-pool-size']}" /></td>
                        <td><h:inputText class="dataInputText" size="50"
                            value="#{setupParams['nuxeo.vcs.max-pool-size']}" /></td>
                    </tr>
                </c:if>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.nuxeo.notification.eMailSubjectPrefix']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['nuxeo.notification.eMailSubjectPrefix']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mailservice.user']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mailservice.user']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mailservice.password']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mailservice.password']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.store.protocol']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.store.protocol']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.transport.protocol']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.transport.protocol']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.pop3.host']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.pop3.host']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.debug']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.debug']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.smtp.host']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.smtp.host']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.smtp.port']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.smtp.port']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.smtp.auth']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.smtp.auth']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.smtp.username']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.smtp.username']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.smtp.password']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.smtp.password']}" /></td>
                </tr>
                <tr>
                    <td><h:outputText styleClass="label"
                        value="#{messages['label.setup.mail.from']}" /></td>
                    <td><h:inputText class="dataInputText" size="50"
                        value="#{setupParams['mail.from']}" /></td>
                </tr>
            </table>
            <a4j:commandButton value="#{messages['action.setup.save']}"
                action="#{setupWizardAction.save()}" reRender="setupPanel"
                styleClass="button" />
            <a4j:commandButton value="#{messages['action.setup.cancel']}"
                action="#{setupWizardAction.resetParameters()}"
                reRender="setupPanel" styleClass="button" />

            <br />
            <br />
            <h2><h:outputText styleClass="label"
                value="#{messages['adminsubtab.sysinfo.advancedsetup']}" /></h2>
            <table>
                <c:forEach var="advancedParamKey"
                    items="#{advancedParams.keySet().toArray()}">
                    <tr>
                        <td><h:outputText styleClass="label"
                            value="#{advancedParamKey}" /></td>
                        <td><h:inputText class="dataInputText" size="100"
                            value="#{advancedParams[advancedParamKey]}" /></td>
                    </tr>
                </c:forEach>
            </table>
            <a4j:commandButton value="#{messages['action.setup.save']}"
                action="#{setupWizardAction.save()}" reRender="setupPanel"
                styleClass="button" />
            <a4j:commandButton value="#{messages['action.setup.cancel']}"
                action="#{setupWizardAction.resetParameters()}"
                reRender="setupPanel" styleClass="button" />

        </a4j:form>
    </c:if>
</a4j:outputPanel></div>