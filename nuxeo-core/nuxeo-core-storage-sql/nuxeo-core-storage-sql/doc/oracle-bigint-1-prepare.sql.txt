-- character uuid to bigint migration for Oracle
-- v0.2 2013-02-21

BEGIN
  -- preparation phase
  EXECUTE IMMEDIATE 'DROP TABLE ACLR_MODIFIED';
  EXECUTE IMMEDIATE 'DROP TABLE ANCESTORS';
  EXECUTE IMMEDIATE 'DROP TRIGGER NX_TRIG_HIERARCHY_UPDATE';
  EXECUTE IMMEDIATE 'DROP TRIGGER NX_TRIG_HIERARCHY_INSERT';
  EXECUTE IMMEDIATE 'DROP TRIGGER NX_TRIG_HIER_READ_ACL_MOD';
  EXECUTE IMMEDIATE 'DROP TRIGGER NX_TRIG_ACLS_MODIFIED';
  EXECUTE IMMEDIATE 'DROP TRIGGER NX_TRIG_ACLR_MODIFIED';
  EXECUTE IMMEDIATE 'DROP TRIGGER NX_TRIG_ANCESTORS_INSERT';
  EXECUTE IMMEDIATE 'DROP TRIGGER NX_TRIG_ANCESTORS_UPDATE';
  EXECUTE IMMEDIATE 'DROP TRIGGER NX_TRIG_ANCESTORS_PROCESS';
  EXECUTE IMMEDIATE 'DROP TRIGGER NX_TRIG_FT_UPDATE';
  EXECUTE IMMEDIATE 'CREATE TABLE tmp_fk(table_name VARCHAR2(99), constraint_name VARCHAR(99))';
  EXECUTE IMMEDIATE 'CREATE TABLE tmp_pk(table_name VARCHAR2(99), constraint_name VARCHAR(99))';
  EXECUTE IMMEDIATE 'CREATE TABLE tmp_idx(table_name VARCHAR2(99), index_name VARCHAR(99))';
  EXECUTE IMMEDIATE 'CREATE TABLE tmp_ftidx(index_name VARCHAR2(99), create_sql VARCHAR(999))';
  EXECUTE IMMEDIATE 'CREATE SEQUENCE hierarchy_seq';
  EXECUTE IMMEDIATE 'CREATE TABLE nx_idmap(id VARCHAR2(36), nid NUMBER(10,0))';
  EXECUTE IMMEDIATE 'CREATE INDEX nx_idmap_idx ON nx_idmap(id)';
END;
